using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using NUnit.Framework;

namespace CQS.Genome.CNV
{
  [TestFixture]
  public class TestCGHReader
  {
    [Test]
    public void Test()
    {
      var actual = new CGHReader().ReadFromFile("../../../data/cgh.txt");
      Assert.AreEqual(517, actual.Count);
      
      Assert.AreEqual("BT20US09513751_252152924105_S01_CGH_107_Sep09", actual[0].FileName);
      Assert.AreEqual("chr1", actual[0].Seqname);
      Assert.AreEqual("p36.33 - p21.1", actual[0].ItemName);
      Assert.AreEqual(759762, actual[0].Start);
      Assert.AreEqual(106817873, actual[0].End);
      Assert.AreEqual(CNVType.DELETION, actual[0].ItemType);
      Assert.AreEqual(0.0, actual[0].Score, 0.0);
      Assert.AreEqual("NCRNA00115, LOC643837, FAM41C, FLJ39609, SAMD11, NOC2L, KLHL17, PLEKHN1, C1orf170, HES4, ISG15, AGRN, C1orf159, MIR200B, MIR200A, MIR429, TTLL10, TNFRSF18, TNFRSF4, SDF4, B3GALT6, FAM132A, UBE2J2, LOC100128842, SCNN1D, ACAP3, PUSL1, CPSF3L, GLTPD1, TAS1R3, DVL1, MXRA8, AURKAIP1, CCNL2, LOC148413, MRPL20, LOC441869, TMEM88B, VWA1, ATAD3C, ATAD3B, ATAD3A, C1orf70, SSU72, MIB2, MMP23B, MMP23A, CDK11B, LOC728661, CDK11A, SLC35E2, NADK, GNB1, CALML6, TMEM52, KIAA1751, GABRD, PRKCZ, C1orf86, LOC100128003, SKI, MORN1, LOC100129534, RER1, PEX10, PLCH2, PANK4, HES5, LOC115110, TNFRSF14, C1orf93, MMEL1, ACTRT2, FLJ42875, PRDM16, ARHGEF16, MEGF6, MIR551A, TPRG1L, WDR8, TP73, KIAA0495, CCDC27, LOC388588, LRRC47, KIAA0562, DFFB, C1orf174, LOC100133612, LOC284661, AJAP1, NPHP4, KCNAB2, CHD5, RPL22, RNF207, ICMT, HES3, GPR153, ACOT7, HES2, ESPN, TNFRSF25, PLEKHG5, NOL9, TAS1R1, ZBTB48, KLHL21, PHF13, THAP3, DNAJC11, CAMTA1, VAMP3, PER3, UTS2, TNFRSF9, PARK7, ERRFI1, SLC45A1, RERE, ENO1, CA6, SLC2A7, SLC2A5, GPR157, MIR34A, H6PD, SPSB1, SLC25A33, TMEM201, PIK3CD, C1orf200, CLSTN1, CTNNBIP1, LZIC, NMNAT1, RBP7, UBE4B, KIF1B, PGD, APITD1, CORT, DFFA, PEX14, CASZ1, C1orf127, TARDBP, MASP2, SRM, EXOSC10, MTOR, ANGPTL7, UBIAD1, PTCHD2, FBXO2, FBXO44, FBXO6, MAD2L2, C1orf187, AGTRAP, MTHFR, CLCN6, NPPA, NPPB, KIAA2013, PLOD1, MFN2, MIIP, TNFRSF8, TNFRSF1B, VPS13D, SNORA59B, SNORA59A, DHRS3, AADACL4, AADACL3, C1orf158, PRAMEF12, PRAMEF1, PRAMEF11, LOC649330, HNRNPCL1, PRAMEF2, PRAMEF4, PRAMEF10, PRAMEF8, PRAMEF7, PRAMEF6, PRAMEF22, PRAMEF5, LOC440563, PRAMEF3, PRAMEF9, PRAMEF15, PRAMEF13, PRAMEF14, PRAMEF18, PRAMEF19, PRAMEF16, PRAMEF20, PRAMEF21, PRAMEF17, PDPN, PRDM2, KIAA1026, C1orf126, TMEM51, FHAD1, EFHD2, CTRC, CELA2A, CELA2B, CASP9, DNAJC16, AGMAT, DDI2, RSC1A1, PLEKHM2, SLC25A34, TMEM82, FBLIM1, UQCRHL, FLJ37453, SPEN, ZBTB17, C1orf64, HSPB7, CLCNKA, CLCNKB, FAM131C, EPHA2, ARHGEF19, C1orf89, FBXO42, C1orf144, SPATA21, NECAP2, CROCCL2, NBPF1, CROCCL1, MST1P2, ESPNP, MST1P9, CROCC, MFAP2, ATP13A2, SDHB, PADI2, PADI1, PADI3, PADI4, PADI6, RCC2, ARHGEF10L, ACTL8, IGSF21, KLHDC7A, PAX7, TAS1R2, ALDH4A1, IFFO2, UBR4, KIAA0090, MRTO4, AKR7L, AKR7A3, AKR7A2, PQLC2, CAPZB, C1orf151, NBL1, HTR6, TMCO4, RNF186, OTUD3, PLA2G2E, PLA2G2A, PLA2G5, PLA2G2D, PLA2G2F, PLA2G2C, UBXN10, VWA5B1, CAMK2N1, MUL1, FAM43B, CDA, PINK1, DDOST, KIF17, SH2D5, HP1BP3, EIF4G3, ECE1, NBPF3, ALPL, RAP1GAP, USP48, LDLRAD2, HSPG2, CELA3B, CELA3A, HSPC157, CDC42, WNT4, ZBTB40, EPHA8, C1QA, C1QC, C1QB, EPHB2, KDM1A, LUZP1, HTR1D, HNRNPR, ZNF436, C1orf213, TCEA3, ASAP3, E2F2, ID3, MDS2, RPL11, TCEB3, C1orf128, LYPLA2, GALE, HMGCL, FUCA1, CNR2, PNRC2, SFRS13A, MYOM3, IL22RA1, IL28RA, LOC284632, GRHL3, C1orf201, NIPAL3, RCAN3, C1orf130, SRRM1, CLIC4, RUNX3, SYF2, C1orf63, RHD, TMEM50A, RHCE, TMEM57, LDLRAP1, MAN1C1, SEPN1, FAM54B, LOC646471, C1orf135, PAQR7, STMN1, PAFAH2, EXTL1, SLC30A2, TRIM63, PDIK1L, GRRP1, ZNF593, CNKSR1, CATSPER4, CCDC21, SH3BGRL3, UBXN11, CD52, AIM1L, ZNF683, LIN28, DHDDS, HMGN2, RPS6KA1, MIR1976, ARID1A, PIGV, ZDHHC18, SFN, GPN2, GPATCH3, NR0B2, NUDC, C1orf172, TRNP1, FAM46B, SLC9A1, WDTC1, TMEM222, SYTL1, MAP3K6, FCN3, CD164L2, GPR3, WASF2, AHDC1, FGR, IFI6, FAM76A, STX12, PPP1R8, SCARNA1, C1orf38, RPA2, SMPDL3B, XKR8, EYA3, LOC653566, PTAFR, DNAJC8, ATPIF1, SESN2, MED18, PHACTR4, SNHG3-RCC1, SNHG3, RCC1, TRNAU1AP, SNHG12, SNORD99, SNORA61, SNORA44, SNORA16A, RAB42, TAF12, RNU11, GMEB1, YTHDF2, OPRD1, EPB41, TMEM200B, SFRS4, MECR, PTPRU, MATN1, LAPTM5, SDC3, PUM1, SNORD103A, SNORD85, PRO0611, NKAIN1, SNRNP40, ZCCHC17, FABP3, SERINC2, LOC284551, TINAGL1, HCRTR1, PEF1, COL16A1, BAI2, SPOCD1, PTP4A2, KHDRBS1, TMEM39B, KPNA6, TXLNA, CCDC28B, IQCC, DCDC2B, C1orf91, EIF3I, MTMR9L, FAM167B, LCK, HDAC1, MARCKSL1, LOC100128071, TSSK3, BSDC1, ZBTB8B, ZBTB8A, ZBTB8OS, RBBP4, SYNC, KIAA1522, YARS, S100PBP, FNDC5, HPCA, TMEM54, RNF19B, AK2, ADC, TRIM62, ZNF362, PHC2, ZSCAN20, CSMD2, HMGB4, C1orf94, GJB5, GJB4, GJB3, GJA4, C1orf212, DLGAP3, ZMYM6, ZMYM1, SFPQ, ZMYM4, KIAA0319L, NCDN, TFAP2E, PSMB2, C1orf216, CLSPN, EIF2C4, EIF2C1, EIF2C3, TEKT2, ADPRHL2, COL8A2, TRAPPC3, MAP7D1, THRAP3, C1orf113, FAM176B, STK40, LSM10, OSCP1, MRPS15, CSF3R, GRIK3, ZC3H12A, MEAF6, SNIP1, DNALI1, GNL2, RSPO1, C1orf109, CDCA8, EPHA10, MANEAL, YRDC, C1orf122, MTF1, INPP5B, SF3A3, FHL3, UTP11L, POU3F1, RRAGC, MYCBP, GJA9, RHBDL2, AKIRIN1, NDUFS5, MACF1, KIAA0754, BMP8A, LOC728448, PABPC4, SNORA55, HEYL, NT5C1A, HPCAL4, PPIE, BMP8B, OXCT2, TRIT1, MYCL1, MFSD2A, CAP1, PPT1, RLF, TMCO2, ZMPSTE24, COL9A2, SMAP2, ZNF643, ZNF642, DEM1, ZNF684, RIMS3, LOC100130557, NFYC, MIR30E, MIR30C1, KCNQ4, CITED4, CTPS, SLFNL1, SCMH1, EDN2, HIVEP3, GUCA2B, GUCA2A, FOXJ3, RIMKLA, ZMYND12, PPCS, CCDC30, PPIH, YBX1, CLDN19, LEPRE1, C1orf50, CCDC23, ERMAP, ZNF691, SLC2A1, FAM183A, EBNA1BP2, WDR65, TMEM125, C1orf210, TIE1, MPL, CDC20, ELOVL1, MED8, C1orf84, KIAA0467, HYI, PTPRF, KDM4A, ST3GAL3, ARTN, IPO13, DPH2, ATP6V0B, B4GALT2, CCDC24, SLC6A9, KLF17, DMAP1, ERI3, RNF220, TMEM53, C1orf228, KIF2C, RPS8, SNORD55, SNORD46, SNORD38A, SNORD38B, BEST4, PLK3, TCTEX1D4, BTBD19, PTCH2, EIF2B3, HECTD3, UROD, ZSWIM5, LOC400752, HPDL, MUTYH, TOE1, TESK2, CCDC163P, MMACHC, PRDX1, AKR1A1, NASP, CCDC17, GPBP1L1, RPS15AP10, TMEM69, IPP, MAST2, PIK3R3, TSPAN1, POMGNT1, C1orf190, RAD54L, LRRC41, UQCRH, NSUN4, FAAH, DMBX1, KNCN, MKNK1, MOBKL2C, ATPAF1, C1orf223, KIAA0494, CYP4B1, CYP4Z2P, CYP4A11, CYP4X1, CYP4Z1, CYP4A22, PDZK1IP1, TAL1, STIL, CMPK1, FOXE3, MGC12982, FOXD2, SKINTL, SLC5A9, SPATA6, AGBL4, BEND5, ELAVL4, DMRTA2, FAF1, CDKN2C, C1orf185, RNF11, TTC39A, EPS15, OSBPL9, NRD1, MIR761, RAB3B, TXNDC12, KTI12, BTF3L4, ZFYVE9, CC2D1B, ORC1L, PRPF38A, ZCCHC11, GPX7, FAM159A, C1orf163, ZYG11B, ZYG11A, ECHDC2, SCP2, PODN, SLC1A7, CPT2, C1orf123, MAGOH, LRP8, FLJ40434, DMRTB1, GLIS1, TMEM48, YIPF1, DIO1, HSPB11, LRRC42, LDLRAD1, TMEM59, C1orf83, CDCP2, CYB5RL, MRPL37, SSBP3, ACOT11, FAM151A, C1orf175, TTC4, PARS2, TTC22, C1orf177, DHCR24, TMEM61, BSND, PCSK9, USP24, PPAP2B, PRKAA2, C1orf168, C8A, C8B, DAB1, MIR548D2, OMA1, TACSTD2, MYSM1, JUN, LOC729467, FGGY, HOOK1, CYP2J2, C1orf87, NFIA, TM2D1, INADL, L1TD1, KANK4, USP1, DOCK7, ANGPTL3, ATG4C, FOXD3, ALG6, ITGB3BP, EFCAB7, DLEU2L, PGM1, ROR1, UBE2U, CACHD1, RAVER2, JAK1, MIR101-1, AK3L1, DNAJC6, LEPR, LEPROT, PDE4B, SGIP1, TCTEX1D1, INSL5, WDR78, MIER1, SLC35D1, C1orf141, IL23R, IL12RB2, SERBP1, GADD45A, GNG12, DIRAS3, GPR177, MIR1262, RPE65, DEPDC1, LRRC7, PIN1L, LRRC40, SFRS11, ANKRD13C, HHLA3, CTH, PTGER3, ZRANB2, MIR186, NEGR1, LRRIQ3, FPGT, TNNI3K, C1orf173, CRYZ, TYW3, LHX8, SLC44A5, ACADM, RABGGTB, SNORD45C, SNORD45A, SNORD45B, MSH4, ASB17, ST6GALNAC3, ST6GALNAC5, PIGK, AK5, ZZZ3, USP33, FAM73A, NEXN, FUBP1, DNAJB4, GIPC2, MGC27382, PTGFR, IFI44L, IFI44, ELTD1, LPHN2, TTLL7, PRKACB, SAMD13, UOX, DNASE2B, RPF1, GNG5, SPATA1, CTBS, C1orf180, SSX2IP, LPAR3, MCOLN2, MCOLN3, WDR63, SYDE2, C1orf52, BCL10, DDAH1, CYR61, ZNHIT6, COL24A1, ODF2L, CLCA2, CLCA1, CLCA4, CLCA3P, SH3GLB1, SEP15, HS2ST1, LOC339524, LMO4, PKN2, GTF2B, CCBL2, RBMXL1, GBP3, GBP1, GBP2, GBP7, GBP4, GBP5, GBP6, LOC400759, LRRC8B, LRRC8C, LRRC8D, LOC492303, ZNF326, BARHL2, ZNF644, HFM1, CDC7, HSP90B3P, TGFBR3, BRDT, EPHX4, BTBD8, KIAA1107, C1orf146, GLMN, RPAP2, GFI1, EVI5, RPL5, SNORD21, SNORA66, FAM69A, MTF2, TMED5, CCDC18, DR1, FNBP1L, BCAR3, MIR760, DNTTIP2, GCLM, ABCA4, ARHGAP29, ABCD3, F3, SLC44A3, CNN3, ALG14, TMEM56, RWDD3, PTBP2, DPYD, MIR137, SNX7, LPPR5, LPPR4, PALMD, MIR548D1, FRRS1, AGL, SLC35A3, HIAT1, SASS6, CCDC76, LRRC39, DBT, RTCD1, MIR553, CDC14A, GPR88, VCAM1, EXTL2, SLC30A7, DPH5, S1PR1, OLFM3, COL11A1, RNPC3, AMY2B, LOC648740, AMY2A, AMY1A, AMY1C, AMY1B", actual[0].Annotation);

      Assert.AreEqual("BT549 US09513751_252152924089_S01_CGH_107_Sep09", actual[516].FileName);
      Assert.AreEqual("chrY", actual[516].Seqname);
      Assert.AreEqual("q12", actual[516].ItemName);
      Assert.AreEqual(59036502, actual[516].Start);
      Assert.AreEqual(59331054, actual[516].End);
      Assert.AreEqual(CNVType.DUPLICATION, actual[516].ItemType);
      Assert.AreEqual(0.0, actual[516].Score, 0.000001);
      Assert.AreEqual("SPRY3, VAMP7, IL9R", actual[516].Annotation);
    }
  }
}
